(this.$WP=this.$WP||[]).push(["mT-Pb2",(e,n)=>{"use strict";var a,i,s,t,o,l,r,u,c,d,g,f,m,p,y,C,S=["OPTIMUS_BRANDED_IMAGE_HIGHLIGHT"],k=({allowClose:e,flow:n,forceLogin:s,contextualMessagingVariant:t,contextualMessageKey:o,contextualMessageParamKey:r,contextualMessageParam:u,contextualMessageSubheaderKey:c,isSignInOnly:d,onClose:g,onFailure:f,funnelKey:m,pid:p})=>{var{login:y,close:C}=l(),k=a(()=>{var e={contextualMessage:o,contextualMessageParamKey:r,contextualMessageParam:u,contextualMessageSubheader:c};return Object.assign({},t?{}:e,{isSignInOnly:d,contextualMessagingVariant:t,funnelKey:m})},[o,u,r,c,t,d,m]),v=S.includes((n||"").toUpperCase());return{login:i(a=>y({flowOrigin:"login",flow:n,isFullWidthMobile:!0,forceLogin:s,requireSecure:s,closeX:e,closeOnDocClick:e,hideBoxShadow:v,extraQueryParams:k,pid:p||40777,onSuccess:a||void 0,onClose:g,onFailure:f}),[e,k,v,n,s,y,g,f,p]),close:C}},v=({members:e,nonMembers:n,messageVariant:a,onClose:l,flow:d="OPTIMUS_BRANDED",funnelKey:f,pid:m})=>{var{userId:p}=s(c),C=g(),S=u("phoenix_plus"),{login:v}=k(Object.assign({allowClose:!0,forceLogin:!1},a&&{flow:d,contextualMessagingVariant:a},{onClose:l,funnelKey:f,pid:m})),[O,I]=t(!1),[{data:h,fetching:M},x]=r({query:y,pause:!p});return o(()=>{p&&x({requestPolicy:"network-only"})},[x,p]),o(()=>{(p||S)&&O&&!M&&((null==h?void 0:h.OptimusBenefits_isSubscribedToOptimus)?C(e):C(n))},[h,M,e,C,n,O,p,S]),i(()=>{p||S?I(!0):v(()=>{I(!0)})},[v,I,p,S])},O=()=>{var e=f(),[{page:n}]=s(d);return i(({locationId:a,listingKey:i=null,funnelKey:s})=>{if(!a||!s)throw new Error("Unable to record user login. Missing offer data - "+JSON.stringify({locationId:a,funnelKey:s}));e({OptimusOffer:{optimusInitialOfferSignedIn:{servletName:n,locationId:a,funnelKey:s,listingKey:i}}})},[e,n])},I=({children:e,forceLogin:n,loginContextualMessageKey:a,shouldLogoutAfterPaymentFailures:l=!1,renderBeforeLogout:r})=>{var[u,g]=t(!n),[f,p]=t(!1),[y]=s(d),{failedCardPayment:C,hasBlockedCardInSession:S,hadBlockedCard:v,clearAllBlockedCards:O}=(()=>{var[e,n]=t(!1),[a,s]=t(new Map);return{failedCardPayment:i(i=>{if(i&&!e){var t=a.get(i);t||(t=0),(t+=1)>=5&&(n(!0),m.set("PlusHadBlockedCards",!0),t=0),s(new Map(a.set(i,t)))}},[e,n,a]),hasBlockedCardInSession:i(()=>e,[e]),hadBlockedCard:i(()=>!!e||m.has("PlusHadBlockedCards"),[e]),clearAllBlockedCards:i(()=>{e&&n(!1),m.has("PlusHadBlockedCards")&&m.remove("PlusHadBlockedCards")},[e,n])}})(),I=v()?"plus_too_many_failed_payments":a,{login:h}=k({allowClose:!1,forceLogin:n,contextualMessageKey:I}),{userId:M}=s(c);o(()=>{M&&u||f||(p(!0),h(()=>g(!0)).finally(()=>p(!1)))},[h,u,f,M]);var x=i(()=>{window.location=`/RegistrationController?flow=${encodeURIComponent("SIGN_OUT")}&pid=${encodeURIComponent(String(k))}&returnTo=${encodeURIComponent(y.path)}&fullscreen=true`},[y.path]),b=l&&S();return o(()=>{b&&x()},[b,x]),b?r?r():null:M&&u?(O(),e({userId:M,failedCardPayment:C})):null},h=e=>!!(null==e?void 0:e.canAccessSecureContent),M=({children:e,contextualMessageKey:n,renderNotSecure:a,skip:i})=>{var{login:l,close:r}=k({allowClose:!1,forceLogin:!0,contextualMessageKey:n}),[{data:u,fetching:d},g]=(()=>{var{userId:e}=s(c),[n,a]=t(null),[i,l]=p({query:C,pause:!e},h);return o(()=>{e!==n&&(a(e),l())},[l,n,e]),o(()=>()=>a(null),[a]),[i,l]})(),[f,m]=t(!1);return o(()=>{u||d||f||i||l(()=>{g(),m(!0)})},[u,g,d,l,f,m,i]),o(()=>()=>r(),[r]),u||i?e():a?a():null};return[()=>{(y=JSON.parse('{"kind":"Document","definitions":[{"kind":"OperationDefinition","operation":"query","name":{"kind":"Name","value":"IsSubscribed"},"variableDefinitions":[],"directives":[],"selectionSet":{"kind":"SelectionSet","selections":[{"kind":"Field","name":{"kind":"Name","value":"OptimusBenefits_isSubscribedToOptimus"},"arguments":[],"directives":[]}]}}],"loc":{"start":0,"end":71}}')).__key=93070980626319,(C=JSON.parse('{"kind":"Document","definitions":[{"kind":"OperationDefinition","operation":"query","name":{"kind":"Name","value":"CanAccessSecureContent"},"variableDefinitions":[],"directives":[],"selectionSet":{"kind":"SelectionSet","selections":[{"kind":"Field","alias":{"kind":"Name","value":"canAccessSecureContent"},"name":{"kind":"Name","value":"OptimusBenefits_canAccessSecureContent"},"arguments":[],"directives":[]}]}}],"loc":{"start":0,"end":106}}')).__key=0xb7349ab36c89,e({OptimusHardGate:I,OptimusSecureLoginGate:M,useOptimusLogin:k,useOptimusLoginNavigation:v,useOptimusLoginTracking:O})},[e=>(a=e.useMemo,i=e.useCallback,s=e.useContext,t=e.useState,o=e.useEffect),e=>l=e.default,e=>r=e.useQuery,e=>u=e.featureIsEnabled,e=>(c=e.Visitor,d=e.Route),e=>g=e.useNavigate,e=>f=e.useInteractionLogger,e=>m=e.default,e=>p=e.default]]},["cDcdfi","VANuRt","5X2em-","-i3PJS","2R4xv2","1yEXVQ","fsml46","jaCyxS","kYmwth"]]);
