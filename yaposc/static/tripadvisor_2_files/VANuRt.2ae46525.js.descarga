(this.$WP=this.$WP||[]).push(["VANuRt",(e,r)=>{"use strict";var o,a,t,n,l,i,s,u,d,c,h,m,p,f,w,g=({options:e,onReady:r,onShowOverlay:a})=>{var[t,n]=o.useState(),[i,s]=o.useState(),[u,d]=o.useState(!1),c="MOBILE"===o.useContext(l).viewportCategory,g=f(),{onSuccess:v,isFullWidthMobile:C}=e,S=o.useCallback(e=>{var r,o=e.resultData||"";if(o){var a=(e=>{var r={};try{r=JSON.parse(e)}catch(r){return console.error("Error parsing controller result data: "+e),null}return"object"!=typeof r?(console.error("Parsed controller result is not an object."),null):{userId:r.user_id,hasCreatedMember:!!r.hasCreatedMember,hasAcceptedTermsOfUse:!!r.hasAcceptedTermsOfUse,loginProvider:r.loginProvider}})(o);null==a||a.hasCreatedMember,g((null==a?void 0:a.hasCreatedMember)?"CREATE":"LOGIN",null==a?void 0:a.userId,"SUCCESS"),v&&v(a)}else v&&v(null);e.jsCallback&&(r=e.jsCallback)&&console.error("Non-empty JSCallback is returned from RegController: "+r)},[v,g]),O=o.useCallback(e=>{e>100&&n(c&&C?"100%":e)},[c,C]),{displayOnShowOverlay:y,onClose:b,onFailure:I}=e,k=o.useCallback(e=>{var o=e,t=(e=>{if(!e)return null;if(!e.origin||0!==e.origin.indexOf("https")||e.origin!==document.location.origin)return null;if(!e.data||!e.data.indexOf||-1===e.data.indexOf("action"))return null;try{var r=JSON.parse(e.data);return r.action?r:null}catch(e){return null}})(o);if((e=>{e&&e.origin&&0===e.origin.indexOf("https://smartlock.google.com")&&e.data&&e.data.type&&e.source&&e.source.postMessage({type:"verifyAck",data:e.data.data},"https://smartlock.google.com")})(o),t){var{action:n}=t;switch(n){case"successClose":S(t);break;case"reloadWindow":console.error("Unexpected reload window message is received from RegController iframe");break;case"fwdToRelativeUrl":var l=t.url||"";l||console.error("No url specified to forward to."),0!==l.indexOf("/")&&console.error("Cannot forward to absolute url: "+l),window.location=l;break;case"resizeFrame":O(t.width),t.height>100&&s(Math.min(t.height,window.innerHeight));break;case"domReady":d(!0),r&&r();break;case"dismiss":b&&b();break;case"showOverlay":y&&a&&a();break;case"generalError":I&&I()}}},[S,y,a,b,r,O,I]);m("message",k);var x=o.useMemo(()=>{var r=e.extraQueryParams||{};Object.keys(r).forEach(e=>{void 0===r[e]&&delete r[e]});var o=new URLSearchParams(Object.assign({flow:e.flow,flowOrigin:e.flowOrigin,pid:""+e.pid,hideNavigation:"true",userRequestedForce:"true",returnTo:"",isLithium:"true"},r));return e.mcid&&o.append("mcid",""+e.mcid),e.locationId&&o.append("locationId",""+e.locationId),e.stateToken&&o.append("stateToken",e.stateToken),void 0!==e.requireSecure&&o.append("requireSecure",""+String(!!e.requireSecure)),"/RegistrationController?"+o.toString()},[e.extraQueryParams,e.flow,e.flowOrigin,e.locationId,e.mcid,e.pid,e.requireSecure,e.stateToken]);return o.createElement("div",{className:h("_8RLaCUf_",{"_1ic0q52-":!c}),style:{width:t,height:i}},o.createElement(p,{className:"_30pzQStV",src:x,title:"regcontroller",style:{width:t,height:i,display:u?"block":"none"}}),o.createElement(w,null))},v=({options:e,closeX:r})=>{var a="MOBILE"===o.useContext(l).viewportCategory,[t,n]=o.useState(!1),i=o.useCallback(()=>{e.displayOnShowOverlay||n(!0)},[e.displayOnShowOverlay]),s=o.useCallback(()=>{n(!0)},[]),u=o.useMemo(()=>o.createElement(g,{options:e,onReady:i,onShowOverlay:s}),[i,e,s]);return o.createElement(d,{onClose:e.onClose,containerProps:{backgroundColor:"transparent",disableBodyScroll:!0},bodyProps:{isFullBleed:!0},enableCloseIcon:t&&r,roundedCorners:!a,hideBoxShadow:e.hideBoxShadow},o.createElement("div",{style:{display:t?"block":"none"}},u),!t&&o.createElement("div",{className:"nUBQ6pZw"},o.createElement(c,{size:"large",variant:"primary"})))},C=()=>{var{userId:e}=o.useContext(i),[r]=o.useContext(s),l=o.useContext(u),d=r.params.geoId||void 0,[c,h]=o.useState({flow:"CORE_COMBINED",flowOrigin:"join",pid:-1}),[m,p]=o.useState({closeX:!0}),f=n(),w=o.useRef(void 0),g=t(()=>o.createElement(v,{options:c,closeX:m.closeX}),{},[c,m]);return{login:o.useCallback(o=>e&&!o.forceLogin?Promise.resolve({userId:e,hasCreatedMember:null}):w.current?w.current:a()?("undefined"!=typeof window&&(window.location=`/RegistrationController?flow=${encodeURIComponent(o.flow||"CORE_COMBINED")}&pid=${encodeURIComponent(String(o.pid||-1))}&returnTo=${encodeURIComponent(r.path)}&fullscreen=true`),new Promise(()=>{})):(w.current=new Promise(e=>{h({flow:o.flow||"CORE_COMBINED",flowOrigin:o.flowOrigin||"join",pid:o.pid||-1,isFullWidthMobile:o.isFullWidthMobile||!1,hideBoxShadow:o.hideBoxShadow||!1,extraQueryParams:o.extraQueryParams||{},displayOnShowOverlay:o.deferShowOverlay,requireSecure:o.requireSecure||!1,locationId:d||-1,onSuccess:r=>{var a={userId:(null==r?void 0:r.userId)||null,hasCreatedMember:!!(null==r?void 0:r.hasCreatedMember),loginProvider:null==r?void 0:r.loginProvider};o.onSuccess&&o.onSuccess(a),g.close(),w.current=null,l({userId:a.userId}),e(a)},onClose:()=>{f({module:"regoverlay",action:"closed",context:[d||"",o.flow].join("|"),value:o.pid||void 0,nonInteraction:!1}),g.close(),w.current=null,o.onClose&&o.onClose()},onFailure:()=>{o.onFailure&&o.onFailure()}}),p({closeX:!1!==o.closeX}),g.open()}),w.current),[e,r.path,d,g,l,f]),close:g.close}},S=({flow:e,flowOrigin:r="login",pid:a=-1,isFullWidthMobile:t=!1,forceLogin:n=!1,extraQueryParams:l={},deferShowLogin:s=!0,requireSecure:d=!1,onLoginSuccess:c,onLoginFailure:h,onShowOverlay:m})=>{var{userId:p}=o.useContext(i),f=o.useContext(u),w={flow:e,flowOrigin:r,pid:a,isFullWidthMobile:t,extraQueryParams:l,displayOnShowOverlay:s,requireSecure:d,onSuccess:e=>{c&&c(),f({userId:(null==e?void 0:e.userId)||null})},onFailure:()=>{h&&h()}};return p&&!n?null:o.createElement(g,{options:w,onShowOverlay:m})};return[()=>{e("default",C),e("AuthGate",S)},[e=>o=e,e=>a=e.default,e=>t=e.useVDOMPortal,e=>n=e.useGARecorder,e=>(l=e.Device,i=e.Visitor,s=e.Route,u=e.Authenticate),e=>d=e.default,e=>c=e.LoadingSpinner,e=>h=e.default,e=>m=e.useWindow,e=>p=e.EmbeddedContent,e=>(f=e.useUserAccountSiftTrackingAction,w=e.SiftTrackingIframe)]]},["cDcdfi","SfdMbo","vq6MSq","fsml46","2R4xv2","O8LbtK","V08PS7","jSLlaY","Dg5_-9","m5ZZFI","f9x1OV"]]);
