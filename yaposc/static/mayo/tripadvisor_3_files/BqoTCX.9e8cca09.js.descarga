(this.$WP=this.$WP||[]).push(["BqoTCX",(e,t)=>{"use strict";var i,a,s,n,o,l,r,d,c,p,m,u,h,g,k,b,v,_,N,O,f,E,S,T,y,D,w,P,I,A,F,C,R,x,L,G,M,B,V,H,U,q,W,K,z,Q,X=e=>{M().dispatch(B.page.hotels.setGoogleOneTapOpen(e))},J=({mutation:e,variables:t,onCompleted:a,className:s,children:n,textInputIsValid:o})=>i.createElement(y,{query:e},({executeMutation:e})=>i.createElement("form",{className:s,onSubmit:i=>{i.preventDefault&&i.preventDefault(),o()&&e(t).then(({data:e})=>{a&&a(e)})}},n)),j=["CheapFlightsSearchResults","CheapFlightsSearchDeals","MobileCheapFlightsSearchResults","MobileCheapFlightsSearchDeals","OptimusHotelCheckout","OptimusSubscriptionCheckout"],Y=e=>{var t=u("mobile_web"),{notifyAdhesion:i}=a.useContext(T),[{page:l,params:r}]=s(w),{newPlusSubscriber:d=!1}=r,c="Hotels"===l||"Hotel_Review"===l,p={};t&&(e.adhesionRendered?(p={bottom:"50px"},i(!0)):p={bottom:"0"});var[g,k]=n({type:"location_id",value:"1",displayValue:""}),[_,N]=n(""),[y,P]=n(!1),I=e=>{N(e)},A=e=>{k(e),N(e.value)},F=t?"_2fUDpJuI":"_2th8Wf8p",C=t?"zhpaqQNz":"_2wtpChqP",R={hometown:g.value||null,userId:e.userId},x=t=>{b({module:"Home_Location_Prompt",action:t,context:e.servlet||"unknown"})};return o(()=>{if(e.ipGeoId&&e.ipGeoId>1&&e.ipGeoNameAndParentName&&""!==e.ipGeoNameAndParentName){var t={type:"location_id",value:e.ipGeoId.toString(),displayValue:e.ipGeoNameAndParentName};k(t),N(t.value)}},[e.ipGeoId,e.ipGeoNameAndParentName]),a.createElement(D,{query:W,variables:{userId:e.userId}},({fetching:i,data:s})=>{var n,o;return i||(t=>{var i,a,s,n,o=!u("home_location_prompt_master"),l=null==t||null==(i=t.memberProfile)||null==(a=i.hometown)?void 0:a.locationId,r=Date.now()-((null==t||null==(s=t.insightProfile)||null==(n=s.uiCardsState)?void 0:n.timestamp)||0)<864e5,p=O.get("homePromptDismissed"),m=j.includes(e.servlet),h=u("optimus_date_picker_test_a"),g=u("optimus_date_picker_test_b");return e.isDatePickerOpen&&c&&(h||g)||d||e.isInterstitialOpen||o||l||r||p||m})(s)?null:(y||(x("Shown_Prompt"),P(!0)),e.onShown(),a.createElement(J,{variables:R,onCompleted:t=>{var i;"OK"===(null==t||null==(i=t.updateMemberProfile)?void 0:i.status)&&(x("Change_Location"),e.onComplete(!0))},textInputIsValid:()=>g&&""!==g.value&&g.value===_,mutation:q},a.createElement("div",{className:m("_2X-vdsOD",F),style:p},a.createElement("span",{className:"_2kaB1CNv"},(null==s||null==(n=s.memberProfile)?void 0:n.avatar)?a.createElement(E,{photo:null==s||null==(o=s.memberProfile)?void 0:o.avatar}):a.createElement(S,{name:"member",className:"_1NtMekVi"})),a.createElement(v,{colorVariant:"TA_GRAY_3",onClick:()=>{O.set("homePromptDismissed",!0),x("Closed_Prompt"),e.onDismiss()}}),a.createElement("div",{className:C},a.createElement("p",{className:"_1fx8WVcR"},h("I_live_in")),a.createElement("p",{className:"_2qltckr0"},h("home_location_things_near_you")),a.createElement("div",{className:"rS__-2YH"},a.createElement("div",{className:"_3A0KrSV5"},a.createElement(f,{className:"_3RUYQLNs",selectedLocation:g,selectionChanged:A,textInputChanged:I,iconType:"map-pin-fill",mode:"cities",includeWorld:!1,resultsAbove:t,max:t?4:8})),a.createElement("button",{className:"_3n_-WaKV"},a.createElement(S,{name:"arrow-right",className:"_1ywEfNLM"})))))))})},Z=[40185,40600],$=e=>{var{trackWouldOpenExplicitPreferences:t}=R("ONBOARDING","GOOGLE_ONETAP"),{trackWouldOpenExplicitPreferences:a}=R("ONBOARDING","FB_ONETAP"),{open:s,isEnabled:n}=C(),o=i.useCallback(()=>{(n||u("account_screen_onb_control"))&&a()},[n,a]),l=i.useCallback(()=>{(n||u("account_screen_onb_control"))&&t()},[n,t]),r=i.useMemo(()=>({GOOGLE_ONETAP:{tracking:l,open:s,enabled:n},FACEBOOK_ONETAP:{tracking:o,open:s,enabled:n}}),[l,o,n,s]),d=(()=>{var[e,t]=i.useState(!1),a=i.useCallback(()=>{t(!0)},[]),s=i.useCallback(e=>{k("cpm_mw_adhesion").emit("dialog_shown",e)},[]);return i.useEffect(()=>(k("cpm_mw_adhesion").on("ad_closed",a),()=>{k("cpm_mw_adhesion").off("ad_closed",a)}),[a]),i.useMemo(()=>({adhesionClosed:e,notifyAdhesion:s}),[e,s])})();return i.createElement(T.Provider,{value:d},i.createElement(H,Object.assign({},e,{dialogTypeToEp:r})))};return[()=>{V=class extends i.Component{constructor(e){super(e),this.onFacebookLoadSdkAndInit=()=>{window.require(["facebook/authutils"],e=>{e.loadSdkAndInit(this.props.fbSdkUrl,this.props.fbConnectAppId,this.props.fbApiVersion),e.queueForInit(this.onFacebookInit)})},this.onFacebookInit=()=>{this.setState({fbSdkInitialized:!0}),window.FB.Event.subscribe("xfbml.render",()=>{this.trackAction("facebook_onetap_rendered")}),window.FB.getLoginStatus(e=>{"connected"===e.status||"not_authorized"===e.status?this.setState({fbUserLoggedIn:!0}):(this.setState({disabled:!0}),this.props.triggerNext())})},this.onFacebookLogin=()=>{this.trackAction("facebook_onetap_clicked"),window.FB.getLoginStatus(e=>{if("connected"===e.status){var{authResponse:t}=e;t&&t.accessToken&&this.onFacebookAccountConnected(t.signedRequest)}})},this.onFacebookAccountConnected=e=>{var t=this.parseFBSignedRequest(e);t&&t.code&&(p.set("FacebookAuthCode2",t.code,{expires:new Date((new Date).getTime()+5e3),domain:this.props.cookieDomain,path:"/"}),window.require(["ta/registration/RegOverlay"],e=>{var t="MOBILE"===this.props.viewportCategory;e.showRegOverlay(null,null,t,{flow:"FACEBOOK_ONETAP",pid:40600,userRequestedForce:"true",extraQueryParams:{social:"true"},displayOnShowOverlay:!0,onClose:()=>{this.dismissFbOneTap()},onSuccess:e=>{this.disableFbOneTap(),e&&e.user_id&&(this.props.trackWouldOpenExplicitPreferences&&this.props.trackWouldOpenExplicitPreferences(),this.props.explicitPreferencesEnabled&&this.props.openExplicitPreferences&&this.props.openExplicitPreferences())}})}))},this.parseFBSignedRequest=e=>{if(!e)return null;var t=e.split(".",2)[1];if(t){var i=atob(t);try{return JSON.parse(i)}catch(e){this.trackAction("facebook_onetap_parseSignedRequestFailed")}}return null},this.dismissFbOneTap=()=>{this.disableFbOneTap(),this.trackAction("facebook_onetap_closed"),this.props.onDismiss()},this.disableFbOneTap=()=>{this.state.disabled||this.setState({disabled:!0})},this.handleGPTSlotRendering=()=>{this.setState({skyAdsRendered:!0})},this.state={fbSdkInitialized:!1,fbUserLoggedIn:!1,disabled:!u("facebook_onetap_mobile")&&!u("facebook_onetap_desktop")}}UNSAFE_componentWillMount(){this.state.disabled&&this.props.triggerNext()}componentDidMount(){this.state.disabled?this.props.triggerNext():(this.trackAction("facebook_onetap_requested"),u("hr_defer_facebook_sdk")||u("h_defer_facebook_sdk")?k("TimeToInteractive").on("TimeToInteractive",this.onFacebookLoadSdkAndInit):this.onFacebookLoadSdkAndInit())}trackAction(e){b({module:"facebook_onetap",action:e,context:""+(this.props.servlet||"unknown")})}render(){if(k("cpm_mw_adhesion").emit("dialog_shown",!this.state.disabled),this.state.disabled||!this.state.fbSdkInitialized||!this.state.fbUserLoggedIn)return null;var e;e=this.props.adhesionRendered?50:0;var t={headline:h("onetap_message_unlock"),subhead:h("onetap_subhead_signin_alerts_deals")};return window.onFacebookOneTapLogin=this.onFacebookLogin,setTimeout(()=>{window.FB.XFBML.parse()},50),i.createElement("div",{className:"MOBILE"===this.props.viewportCategory?m("NQeSfAxh","_3-UoiMbA"):m("NQeSfAxh","_3zobsZtE",this.state.skyAdsRendered?"_2nonY0Sw":""),style:{bottom:"MOBILE"===this.props.viewportCategory?e+"px":"unset"}},i.createElement(v,{onClick:this.dismissFbOneTap}),i.createElement("div",{className:"_1VkTcBsg"},i.createElement("div",{className:"_1-osJ2zT"},i.createElement("div",null,t.headline)),i.createElement("p",{className:"_2bf7E7rd"},t.subhead),i.createElement("div",{className:"_2ssYmy7_"},i.createElement("div",{className:"_3FM5ZI5n"},i.createElement("div",{className:"fb-login-button","data-width":"100%","data-max-rows":"1","data-size":"large","data-button-type":"continue_with","data-show-faces":"true","data-auto-logout-link":"false","data-use-continue-as":"true","data-scope":"email,user_hometown,user_friends,user_likes,user_location,user_status,user_photos","data-onlogin":"window.onFacebookOneTapLogin();",style:{width:"100%"}}))),i.createElement("div",{className:"_1IXaQIsM"},g(h("terms_and_policy_links",{0:"/pages/terms.html",1:"/pages/privacy.html",2:"legalLink"})))),i.createElement(_,{size:"5x1",position:"sky",callback:this.handleGPTSlotRendering}))}},U=c(e=>({fbApiVersion:e.auth.fbApi.apiVersion,fbConnectAppId:e.auth.fbApi.facebookConnectAppId,fbSdkUrl:e.auth.fbApi.sdkUrl,servlet:e.meta.initialServletName,cookieDomain:e.meta.cookieDomain,viewportCategory:e.meta.device.viewportCategory}))(V),J.defaultProps={onCompleted:()=>{},className:"",children:null},(q=JSON.parse('{"kind":"Document","definitions":[{"kind":"OperationDefinition","operation":"mutation","name":{"kind":"Name","value":"HomeLocationEdit"},"variableDefinitions":[{"kind":"VariableDefinition","variable":{"kind":"Variable","name":{"kind":"Name","value":"userId"}},"type":{"kind":"NonNullType","type":{"kind":"NamedType","name":{"kind":"Name","value":"String"}}},"directives":[]},{"kind":"VariableDefinition","variable":{"kind":"Variable","name":{"kind":"Name","value":"hometown"}},"type":{"kind":"NamedType","name":{"kind":"Name","value":"Int"}},"directives":[]}],"directives":[],"selectionSet":{"kind":"SelectionSet","selections":[{"kind":"Field","name":{"kind":"Name","value":"updateMemberProfile"},"arguments":[{"kind":"Argument","name":{"kind":"Name","value":"userId"},"value":{"kind":"Variable","name":{"kind":"Name","value":"userId"}}},{"kind":"Argument","name":{"kind":"Name","value":"hometown"},"value":{"kind":"Variable","name":{"kind":"Name","value":"hometown"}}}],"directives":[],"selectionSet":{"kind":"SelectionSet","selections":[{"kind":"Field","name":{"kind":"Name","value":"status"},"arguments":[],"directives":[]}]}}]}}],"loc":{"start":0,"end":149}}')).__key=45378370068463,q.loc.source={body:"294579a0dfef"},(W=JSON.parse('{"kind":"Document","definitions":[{"kind":"OperationDefinition","operation":"query","name":{"kind":"Name","value":"HomeLocationQuery"},"variableDefinitions":[{"kind":"VariableDefinition","variable":{"kind":"Variable","name":{"kind":"Name","value":"userId"}},"type":{"kind":"NonNullType","type":{"kind":"NamedType","name":{"kind":"Name","value":"String"}}},"directives":[]}],"directives":[],"selectionSet":{"kind":"SelectionSet","selections":[{"kind":"Field","name":{"kind":"Name","value":"memberProfile"},"arguments":[{"kind":"Argument","name":{"kind":"Name","value":"userId"},"value":{"kind":"ObjectValue","fields":[{"kind":"ObjectField","name":{"kind":"Name","value":"id"},"value":{"kind":"Variable","name":{"kind":"Name","value":"userId"}}}]}}],"directives":[],"selectionSet":{"kind":"SelectionSet","selections":[{"kind":"Field","name":{"kind":"Name","value":"avatar"},"arguments":[],"directives":[],"selectionSet":{"kind":"SelectionSet","selections":[{"kind":"Field","name":{"kind":"Name","value":"id"},"arguments":[],"directives":[]},{"kind":"Field","name":{"kind":"Name","value":"photoSizes"},"arguments":[],"directives":[],"selectionSet":{"kind":"SelectionSet","selections":[{"kind":"Field","name":{"kind":"Name","value":"url"},"arguments":[],"directives":[]},{"kind":"Field","name":{"kind":"Name","value":"width"},"arguments":[],"directives":[]},{"kind":"Field","name":{"kind":"Name","value":"height"},"arguments":[],"directives":[]}]}}]}},{"kind":"Field","name":{"kind":"Name","value":"hometown"},"arguments":[],"directives":[],"selectionSet":{"kind":"SelectionSet","selections":[{"kind":"Field","name":{"kind":"Name","value":"locationId"},"arguments":[],"directives":[]}]}}]}},{"kind":"Field","name":{"kind":"Name","value":"insightProfile"},"arguments":[],"directives":[],"selectionSet":{"kind":"SelectionSet","selections":[{"kind":"Field","name":{"kind":"Name","value":"uiCardsState"},"arguments":[],"directives":[],"selectionSet":{"kind":"SelectionSet","selections":[{"kind":"Field","name":{"kind":"Name","value":"timestamp"},"arguments":[],"directives":[]}]}}]}}]}}],"loc":{"start":0,"end":300}}')).__key=0xad506b83a768,W.loc.source={body:"ad506b83a768"},K=l((e,t)=>{var i=t("/data/1.0/homelocation/ipGeoInfo");return()=>{var t=i&&i.get().data;return{servlet:e.meta.initialServletName,userId:e.auth.loggedInUserId,viewportCategory:e.meta.device.viewportCategory,ipGeoId:null==t?void 0:t.ipGeoId,ipGeoNameAndParentName:null==t?void 0:t.ipGeoNameAndParentName,isDatePickerOpen:e.page.isDatePickerOpen,isInterstitialOpen:e.page.isInterstitialOpen}}})(Y),z=G.component.onUsage(()=>t("454gno"),"default"),H=class e extends i.Component{static isQualtricsEnabled(){return new Promise(e=>{u("qualtrics_surveys_any")&&window.require(["ta/support/Qualtrics"],t=>{e(t.seenThisPageView()||t.canDisplaySmart()||t.canDisplay())}),e(!1)})}constructor(e){super(e),this.onGoogleOneTapDismiss=()=>{P(this.props.sessionId),X(!1)},this.onGoogleOneTapTriggerNext=()=>{this.setState({dialogType:"FACEBOOK_ONETAP"})},this.onFacebookOneTapDismiss=()=>{P(null)},this.onFacebookOneTapTriggerNext=()=>{this.setState({dialogType:"NONE"})},this.onHomeLocationDismiss=()=>{this.setState({dialogType:"NONE"})},this.onHomeLocationComplete=()=>{this.setState({dialogType:"NONE"})},this.onHomeLocationShown=()=>{k("home-location-prompt").emit("shown")},this.onRegistrationOverlayShown=(e,t)=>{Z.includes(t)||this.setState({dialogsDisabled:!0})},this.setupRegDialog=()=>{if(k("Onboarding").on("loginSuccess",this.disableDialog),k("registration-overlay").on("shown",this.onRegistrationOverlayShown),k("FlightList").on("AirwatchInterstitialOpened",this.disableDialog),I.includes(this.props.servlet)||"ShowUserReviews"===this.props.servlet||"MobileShowUserReviews"===this.props.servlet){if(k("DatePicker").on("clicked",this.disableDialog),k("global-nav").on("sidebarOpened",this.disableDialog),k("hotels-sort-filter-entry").on("openSort",this.disableDialog),k("hotels-sort-filter-entry").on("openFilters",this.disableDialog),k("hr-persistent-footer").on("show",this.disableDialog),k("h-map").on("open-trigger-clicked",this.disableDialog),k("h-map").on("toggle-trigger-clicked",this.disableDialog),k("rooms-guests").on("popped",this.disableDialog),this.props.defaultDates&&!N.wasDismissed(this.props.detailPage)&&"MOBILE"===this.props.viewportCategory)return k("rooms-guests").on("firstUserUpdate",this.enableDialog),k("picker-autoadvance").on("flow-complete",this.enableDialog),void k("pop-calendar").on("dismissed",this.enableDialog);k("responsiveStayDates").on("calendarInteracted",this.disableDialog)}if(u("disable_reg_dialog_for_hardgate")&&"GOOGLE_ONETAP"===this.initialDialogType&&this.props.isGatingPageCountTriggerReached)this.disableDialog();else{if(!A()){var e=window.googletag||{cmd:[]};return e.cmd.push(()=>{e.pubads().addEventListener("slotRenderEnded",e=>{(null==e?void 0:e.advertiserId)!==x&&this.setState({adhesionRendered:!0}),this.enableDialog()})}),k("cpm_mw_adhesion").on("ad_closed",()=>{this.setState({adhesionRendered:!1})}),void setTimeout(this.enableDialog,4e3)}this.enableDialog()}},this.initialDialogType=void 0,this.decideInitialDialogType=()=>{var e=!this.props.isMember&&!F(this.props.sessionId),t=this.props.isMember,i="NONE";return e?i="GOOGLE_ONETAP":t&&(i="HOME_LOCATION_PROMPT"),i},this.enableDialog=()=>{"NONE"===this.state.dialogType&&this.setState({dialogType:this.initialDialogType})},this.disableDialog=()=>{"NONE"!==this.state.dialogType&&this.setState({dialogType:"NONE",dialogsDisabled:!0})},this.state={dialogType:"NONE",adhesionRendered:!1,dialogsDisabled:!1}}componentDidMount(){this.initialDialogType=this.decideInitialDialogType(),"NONE"!==this.initialDialogType?e.isQualtricsEnabled().then(e=>{e||this.setupRegDialog()}):k("reg_dialog").emit("all_dismissed")}componentDidUpdate(e){!e.isMember&&this.props.isMember&&this.disableDialog()}isAdhesionRendered(){return L()||this.state.adhesionRendered}render(){var{dialogsDisabled:e,dialogType:t}=this.state,a=()=>i.createElement(i.Fragment,null),s=[],n="registration_dialog";if(e)return null;switch(t){case"GOOGLE_ONETAP":s=["google_one_tap","facebook_one_tap"],a=({dismiss:e})=>i.createElement(z,{onDismiss:()=>{e(),this.onGoogleOneTapDismiss()},onShow:()=>X(!0),triggerNext:this.onGoogleOneTapTriggerNext,servletName:this.props.servlet,openExplicitPreferences:this.props.dialogTypeToEp.GOOGLE_ONETAP.open,explicitPreferencesEnabled:this.props.dialogTypeToEp.GOOGLE_ONETAP.enabled,trackWouldOpenExplicitPreferences:this.props.dialogTypeToEp.GOOGLE_ONETAP.tracking}),n="google_registration_dialog";break;case"FACEBOOK_ONETAP":s=["google_one_tap","facebook_one_tap"],a=({dismiss:e})=>i.createElement(U,{onDismiss:()=>{e(),this.onFacebookOneTapDismiss()},triggerNext:()=>{e(),this.onFacebookOneTapTriggerNext()},adhesionRendered:this.isAdhesionRendered(),openExplicitPreferences:this.props.dialogTypeToEp.FACEBOOK_ONETAP.open,explicitPreferencesEnabled:this.props.dialogTypeToEp.FACEBOOK_ONETAP.enabled,trackWouldOpenExplicitPreferences:this.props.dialogTypeToEp.FACEBOOK_ONETAP.tracking}),n="facebook_registration_dialog"}var o=null;return this.props.isDatePickerPage||(o=i.createElement(r,{factory:()=>null,eventTypes:["skip_100"],renderKey:"skip_100",tier:100,skip:!0})),"HOME_LOCATION_PROMPT"===t?i.createElement(i.Fragment,null,o,i.createElement(K,{adhesionRendered:this.isAdhesionRendered(),onDismiss:this.onHomeLocationDismiss,onShown:this.onHomeLocationShown,onComplete:this.onHomeLocationComplete})):this.props.isMember||F(this.props.sessionId)||this.props.isPaywallBlocking?i.createElement(i.Fragment,null,o,i.createElement(r,{factory:a,eventTypes:["skip_200"],renderKey:"skip_200",tier:200,skip:!0})):s.length>0?i.createElement(i.Fragment,null,o,i.createElement(r,{factory:a,eventTypes:s,renderKey:n,tier:200})):null}},Q=l({data:(e,t)=>(K.stage(e,t),()=>{var t,i,a,s,n;return{isMember:e.auth.isMember,isDatePickerPage:e.page.isDatePickerPage,isPaywallBlocking:e.page.isPaywallBlocking,sessionId:e.tracking.sessionId,viewportCategory:e.meta.device.viewportCategory,servlet:e.meta.initialServletName,defaultDates:!!(e.travelerInfo.hotels||{}).defaultDates,detailPage:!!(null==(t=e.page)?void 0:t.detailId),isGatingPageCountTriggerReached:d((null==(i=e.lithiumRoute)||null==(a=i[0])?void 0:a.page)||"Unknown",(null==(s=e.lithiumRoute)||null==(n=s[0])?void 0:n.params)||{})}}),actions:{}})($),e("default",Q)},[e=>(i=e,a=e.default,s=e.useContext,n=e.useState,o=e.useEffect),e=>l=e.bind,e=>r=e.PopupHierarchyRender,e=>d=e.pageCountTriggerReached,e=>c=e.connect,e=>p=e.default,e=>m=e.default,e=>u=e.featureIsEnabled,e=>(h=e.localize,g=e.unescaped),e=>k=e.createRadio,e=>b=e.default,e=>v=e.CloseIcon,e=>_=e.ListenToGPTSlotRendering,e=>N=e.default,e=>O=e.default,e=>f=e.GeoSelector,e=>E=e.Avatar,e=>S=e.Icon,e=>T=e.PromptsContext,e=>(y=e.Mutation,D=e.Query),e=>w=e.Route,e=>(P=e.setRegDialogDismissed,I=e.HOTEL_SERVLETS,A=e.shouldIgnoreAdhesionUnit,F=e.shouldSuppressRegistrationDialog),e=>C=e.default,e=>R=e.default,e=>(x=e.ADHESION_COLLAPSE_ADVERTISER_ID,L=e.doesAdExistOnPage),e=>G=e,e=>(M=e.getStore,B=e.actions)]]},["cDcdfi","RiHMo-","drdfeZ","wU942v","h74DsO","vmXh3M","jSLlaY","-i3PJS","535agn","l6BSGt","Jk5sjx","xegF5W","w2XwHO","IuX4Ar","jaCyxS","zPgUM0","Hgrhyo","_qQcW3","HDgDKt","5X2em-","2R4xv2","MWFqPp","x5AnXu","2NwMnm","Oc3sTL","pLbCP4","aunxON"]]);
