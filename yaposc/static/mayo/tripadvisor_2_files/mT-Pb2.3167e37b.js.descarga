(this.$WP=this.$WP||[]).push(["mT-Pb2",(e,n)=>{"use strict";var a,o,i,s,t,l,r,u,c,d,g,f,m,p,y,C,S=["OPTIMUS_BRANDED_IMAGE_HIGHLIGHT"],k=({allowClose:e,flow:n,forceLogin:i,contextualMessagingVariant:s,contextualMessageKey:t,contextualMessageParamKey:r,contextualMessageParam:u,contextualMessageSubheaderKey:c,isSignInOnly:d,onClose:g,onFailure:f,funnelKey:m,pid:p})=>{var{login:y,close:C}=l(),k=a(()=>{var e={contextualMessage:t,contextualMessageParamKey:r,contextualMessageParam:u,contextualMessageSubheader:c};return Object.assign({},s?{}:e,{isSignInOnly:d,contextualMessagingVariant:s,funnelKey:m})},[t,u,r,c,s,d,m]),v=S.includes((n||"").toUpperCase());return{login:o(a=>y({flowOrigin:"login",flow:n,isFullWidthMobile:!0,forceLogin:i,requireSecure:i,closeX:e,closeOnDocClick:e,hideBoxShadow:v,extraQueryParams:k,pid:p||40777,onSuccess:a||void 0,onClose:g,onFailure:f}),[e,k,v,n,i,y,g,f,p]),close:C}},v=({members:e,nonMembers:n,messageVariant:a,onClose:l,flow:d="OPTIMUS_BRANDED",funnelKey:f,pid:m})=>{var{userId:p}=i(c),C=g(),S=u("phoenix_plus"),{login:v}=k(Object.assign({allowClose:!0,forceLogin:!1},a&&{flow:d,contextualMessagingVariant:a},{onClose:l,funnelKey:f,pid:m})),[O,b]=s(!1),[{data:I,fetching:h},M]=r({query:y,pause:!p});return t(()=>{p&&M({requestPolicy:"network-only"})},[M,p]),t(()=>{(p||S)&&O&&!h&&((null==I?void 0:I.OptimusBenefits_isSubscribedToOptimus)?C(e):C(n))},[I,h,e,C,n,O,p,S]),o(()=>{p||S?b(!0):v(()=>{b(!0)})},[v,b,p,S])},O=()=>{var e=f(),[{page:n}]=i(d);return o(({locationId:a,listingKey:o=null,funnelKey:i})=>{if(!a||!i)throw new Error("Unable to record user login. Missing offer data - "+JSON.stringify({locationId:a,funnelKey:i}));e({OptimusOffer:{optimusInitialOfferSignedIn:{servletName:n,locationId:a,funnelKey:i,listingKey:o}}})},[e,n])},b=({children:e,forceLogin:n,loginContextualMessageKey:a,shouldLogoutAfterPaymentFailures:l=!1,renderBeforeLogout:r})=>{var[u,g]=s(!n),[f,p]=s(!1),[y]=i(d),{failedCardPayment:C,hasBlockedCardInSession:S,hadBlockedCard:v,clearAllBlockedCards:O}=(()=>{var[e,n]=s(!1),[a,i]=s(new Map);return{failedCardPayment:o(o=>{if(o&&!e){var s=a.get(o);s||(s=0),(s+=1)>=5&&(n(!0),m.set("PlusHadBlockedCards",!0),s=0),i(new Map(a.set(o,s)))}},[e,n,a]),hasBlockedCardInSession:o(()=>e,[e]),hadBlockedCard:o(()=>!!e||m.has("PlusHadBlockedCards"),[e]),clearAllBlockedCards:o(()=>{e&&n(!1),m.has("PlusHadBlockedCards")&&m.remove("PlusHadBlockedCards")},[e,n])}})(),b=v()?"plus_too_many_failed_payments":a,{login:I}=k({allowClose:!1,forceLogin:n,contextualMessageKey:b}),{userId:h}=i(c);t(()=>{h&&u||f||(p(!0),I(()=>g(!0)).finally(()=>p(!1)))},[I,u,f,h]);var M=o(()=>{window.location=`/RegistrationController?flow=${encodeURIComponent("SIGN_OUT")}&pid=${encodeURIComponent(String(k))}&returnTo=${encodeURIComponent(y.path)}&fullscreen=true`},[y.path]),x=l&&S();return t(()=>{x&&M()},[x,M]),x?r?r():null:h&&u?(O(),e({userId:h,failedCardPayment:C})):null},I=e=>!!(null==e?void 0:e.canAccessSecureContent),h=({children:e,contextualMessageKey:n,renderNotSecure:a,skip:o})=>{var{login:l,close:r}=k({allowClose:!1,forceLogin:!0,contextualMessageKey:n}),[{data:u,fetching:d},g]=(()=>{var{userId:e}=i(c),[n,a]=s(null),[o,l]=p({query:C,pause:!e},I);return t(()=>{e!==n&&(a(e),l())},[l,n,e]),t(()=>()=>a(null),[a]),[o,l]})(),[f,m]=s(!1);return t(()=>{u||d||f||o||l(()=>{g(),m(!0)})},[u,g,d,l,f,m,o]),t(()=>()=>r(),[r]),u||o?e():a?a():null};return[()=>{(y=JSON.parse('{"kind":"Document","definitions":[{"kind":"OperationDefinition","operation":"query","name":{"kind":"Name","value":"IsSubscribed"},"variableDefinitions":[],"directives":[],"selectionSet":{"kind":"SelectionSet","selections":[{"kind":"Field","name":{"kind":"Name","value":"OptimusBenefits_isSubscribedToOptimus"},"arguments":[],"directives":[]}]}}],"loc":{"start":0,"end":71}}')).__key=93070980626319,y.loc.source={body:"54a5c6bd378f"},(C=JSON.parse('{"kind":"Document","definitions":[{"kind":"OperationDefinition","operation":"query","name":{"kind":"Name","value":"CanAccessSecureContent"},"variableDefinitions":[],"directives":[],"selectionSet":{"kind":"SelectionSet","selections":[{"kind":"Field","alias":{"kind":"Name","value":"canAccessSecureContent"},"name":{"kind":"Name","value":"OptimusBenefits_canAccessSecureContent"},"arguments":[],"directives":[]}]}}],"loc":{"start":0,"end":106}}')).__key=0xb7349ab36c89,C.loc.source={body:"b7349ab36c89"},e({OptimusHardGate:b,OptimusSecureLoginGate:h,useOptimusLogin:k,useOptimusLoginNavigation:v,useOptimusLoginTracking:O})},[e=>(a=e.useMemo,o=e.useCallback,i=e.useContext,s=e.useState,t=e.useEffect),e=>l=e.default,e=>r=e.useQuery,e=>u=e.featureIsEnabled,e=>(c=e.Visitor,d=e.Route),e=>g=e.useNavigate,e=>f=e.useInteractionLogger,e=>m=e.default,e=>p=e.default]]},["cDcdfi","VANuRt","5X2em-","-i3PJS","2R4xv2","1yEXVQ","fsml46","jaCyxS","kYmwth"]]);
